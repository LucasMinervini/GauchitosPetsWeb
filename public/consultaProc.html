<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Gestión de Productos</title>
        <link rel="stylesheet" href="interfaz.css">
    </head>
    <body>
        <h1>Gestión de Productos</h1>

    
        <section>
            <h2>Obtener producto por ID</h2>
            <input type="text" id="productId" placeholder="ID del producto">
            <button onclick="getProductById()">Buscar Producto</button>
            <div id="product"></div>
        </section>

        <section>
            <h2>Obtener producto por nombre</h2>
            <input type="text" id="productName" placeholder="Nombre del producto">
            <button onclick="getProductByName()">Buscar Producto</button>
            <div id="productByName"></div>
        </section>

        <section>
            <h2>Crear nuevo producto</h2>
            <form id="createProductForm">
                <input type="text" id="name" placeholder="Nombre" required>
                <input type="text" id="sku" placeholder="SKU" required>
                <input type="text" id="description" placeholder="Descripción" required>
                <input type="number" id="retail_price" placeholder="Precio de venta" required>
                <input type="number" id="cost" placeholder="Costo" required>
                <input type="number" id="stock_quantity" placeholder="Cantidad en stock" required>
                <input type="number" id="category_id" placeholder="ID de categoría" required>
                <input type="number" id="provider_id" placeholder="ID de proveedor" required>
                <button type="submit">Crear Producto</button>
            </form>
        </section>
    
        <section>
            <h2>Borrar producto por ID</h2>
            <input type="text" id="deleteProductId" placeholder="ID del producto">
            <button onclick="deleteProductById()">Borrar Producto</button>
        </section>
    
        <section>
            <h2>Actualizar producto por ID</h2>
            <input type="text" id="updateProductId" placeholder="ID del producto" required>
            <input type="text" id="updateName" placeholder="Nombre">
            <input type="text" id="updateSku" placeholder="SKU">
            <input type="text" id="updateDescription" placeholder="Descripción">
            <input type="number" id="updateRetailPrice" placeholder="Nuevo precio de venta">
            <input type="number" id="updateCost" placeholder="Nuevo costo">
            <input type="number" id="updateStockQuantity" placeholder="Cantidad en stock">
            <input type="number" id="updateCategoryId" placeholder="ID de categoría">
            <input type="number" id="updateProviderId" placeholder="ID de proveedor">
            <button onclick="updateProductById()">Actualizar Producto</button>
            <div id="updateResponse"></div>
        </section>
<script>
    const apiUrl = "http://localhost:8080/api/products";
    // Obtener producto por ID
    function getProductById() {
        const productId = document.getElementById('productId').value;
        fetch(`${apiUrl}/${productId}`)
            .then(response => response.json())
            .then(product => {
                let output = '<h3>Detalle del producto</h3>';
                output += `
                    <p>ID: ${product.id}</p>
                    <p>Nombre: ${product.name}</p>
                    <p>SKU: ${product.sku}</p>
                    <p>Descripción: ${product.description}</p>
                    <p>Precio de venta: ${product.retail_price}</p>
                    <p>Costo: ${product.cost}</p>
                    <p>Cantidad en stock: ${product.stock_quantity}</p>
                    <p>Categoría ID: ${product.category_id}</p>
                    <p>Proveedor ID: ${product.provider_id}</p>
                `;
                document.getElementById('product').innerHTML = output;
            })
            .catch(error => console.error('Error:', error));
    }
    // Obtener producto por Nombre
    function getProductByName() {
    const productName = document.getElementById('productName').value;
    fetch(`${apiUrl}/${productName}`)
        .then(response => {
            if (!response.ok) {
                throw new Error('Producto no encontrado');
            }
            return response.json();
        })
        .then(product => {
            let output = '<h3>Detalle del producto</h3>';
            output += `
                <p>ID: ${product.id}</p>
                <p>Nombre: ${product.name}</p>
                <p>SKU: ${product.sku}</p>
                <p>Descripción: ${product.description}</p>
                <p>Precio de venta: ${product.retail_price}</p>
                <p>Costo: ${product.cost}</p>
                <p>Cantidad en stock: ${product.stock_quantity}</p>
                <p>Categoría ID: ${product.category_id}</p>
                <p>Proveedor ID: ${product.provider_id}</p>
            `;
            document.getElementById('productByName').innerHTML = output;
        })
        .catch(error => {
            console.error('Error:', error);
            document.getElementById('productByName').innerHTML = '<p>Producto no encontrado</p>';
        });
}
    // Crear nuevo producto
    document.getElementById('createProductForm').addEventListener('submit', function (e) {
        e.preventDefault();
    
        const product = {
            name: document.getElementById('name').value,
            sku: document.getElementById('sku').value,
            description: document.getElementById('description').value,
            retail_price: parseFloat(document.getElementById('retail_price').value),
            cost: parseFloat(document.getElementById('cost').value),
            stock_quantity: parseInt(document.getElementById('stock_quantity').value),
            category_id: parseInt(document.getElementById('category_id').value),
            provider_id: parseInt(document.getElementById('provider_id').value)
        };
    
        fetch(apiUrl, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(product)
        })
            .then(response => response.json())
            .then(data => {
                alert('Producto creado exitosamente');
                document.getElementById('createProductForm').reset();
            })
            .catch(error => console.error('Error:', error));
    });
    
    // Borrar producto por ID
    function deleteProductById() {
        const productId = document.getElementById('deleteProductId').value;
        fetch(`${apiUrl}/${productId}`, {
            method: 'DELETE'
        })
            .then(response => response.json())
            .then(data => {
                alert('Producto borrado exitosamente');
            })
            .catch(error => console.error('Error:', error));
    }
    
    // Actualizar producto por ID
function updateProductById() {
    const productId = document.getElementById('updateProductId').value;
    const updatedData = {};

    // Recolectar todos los posibles campos de entrada
    const fields = [
        'updateName',
        'updateSku',
        'updateDescription',
        'updateRetailPrice',
        'updateCost',
        'updateStockQuantity',
        'updateCategoryId',
        'updateProviderId'
    ];

    fields.forEach(field => {
        const value = document.getElementById(field).value;
        if (value) {
            // Convertir los valores a los tipos de datos apropiados
            const key = field.replace('update', '').toLowerCase();
            updatedData[key] = isNaN(value) ? value : parseFloat(value);
        }
    });

    // Verificar que haya al menos un campo para actualizar
    if (Object.keys(updatedData).length === 0) {
        alert('Por favor, proporciona al menos un campo para actualizar');
        return;
    }

    fetch(`${apiUrl}/${productId}`, {
        method: 'PATCH',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(updatedData)
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Error al actualizar el producto');
        }
        return response.json();
    })
    .then(data => {
        document.getElementById('updateResponse').innerHTML = 'Producto actualizado exitosamente';
        console.log('Producto actualizado:', data);
    })
    .catch(error => {
        document.getElementById('updateResponse').innerHTML = 'Error al actualizar el producto';
        console.error('Error:', error);
    });
}
    </script> 
    </body>
    </html>